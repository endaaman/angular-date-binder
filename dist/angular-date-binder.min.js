"use strict";angular.module("angularDateBinder",[]).directive("bindDate",["$parse",function($parse){return{restrict:"A",scope:!0,link:function(scope,element,attrs){var applyDateObject,calcLastDate,current,equalDate,getter,refresh,setter,storeDateObject;return equalDate=function(d1,d2){return!!d1&&!!d2&&d1.getTime()===d2.getTime()},getter=$parse(attrs.bindDate),setter=$parse(attrs.bindDate).assign,storeDateObject=function(){return getter(scope.$parent)},applyDateObject=function(date){return setter(scope.$parent,date),setter(scope,date)},current=storeDateObject(),calcLastDate=function(date){return new Date(date.getFullYear(),date.getMonth()+1,0).getDate()},refresh=function(){return current=new Date(current.getTime()),scope.$year=current.getFullYear(),scope.$year=current.getFullYear(),scope.$month=current.getMonth()+1,scope.$date=current.getDate(),scope.$hours=current.getHours(),scope.$minutes=current.getMinutes(),scope.$seconds=current.getSeconds(),scope.$lastDate=calcLastDate(current),applyDateObject(current)},scope.$parent.$watch(attrs.bindDate,function(newDateObject,oldDateObject){return newDateObject&&!equalDate(newDateObject,oldDateObject)?(current=newDateObject,refresh()):void 0}),scope.$watch(attrs.bindDate,function(newDateObject,oldDateObject){return newDateObject&&!equalDate(newDateObject,oldDateObject)?(current=newDateObject,refresh()):void 0}),scope.$watch("$year",function(newYear,oldYear){return newYear&&newYear!==oldYear?(current.setFullYear(newYear),refresh()):void 0}),scope.$watch("$month",function(newMonth,oldMonth){return newMonth&&newMonth!==oldMonth?(current.setMonth(newMonth-1),refresh()):void 0}),scope.$watch("$date",function(newDate,oldDate){return newDate&&newDate!==oldDate?(current.setDate(newDate),refresh()):void 0}),scope.$watch("$hours",function(newHours,oldHours){return newHours&&newHours!==oldHours?(current.setHours(newHours),refresh()):void 0}),scope.$watch("$minutes",function(newMinutes,oldMinutes){return newMinutes&&newMinutes!==oldMinutes?(current.setMinutes(newMinutes),refresh()):void 0}),scope.$watch("$seconds",function(newSeconds,oldSeconds){return newSeconds&&newSeconds!==oldSeconds?(current.setSeconds(newSeconds),refresh()):void 0}),refresh()}}}]);